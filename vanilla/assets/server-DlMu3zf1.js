import{b as e,c as t,d as n}from"./items-QQw4QxhY.js";const r=async()=>await new Promise(e=>setTimeout(e,200));function i(){let t={};return e.forEach(e=>{let n=e.category1,r=e.category2;t[n]||(t[n]={}),r&&!t[n][r]&&(t[n][r]={})}),t}function a(e,t){let n=[...e];if(t.search){let e=t.search.toLowerCase();n=n.filter(t=>t.title.toLowerCase().includes(e)||t.brand.toLowerCase().includes(e))}if(t.category1&&(n=n.filter(e=>e.category1===t.category1)),t.category2&&(n=n.filter(e=>e.category2===t.category2)),t.sort)switch(t.sort){case`price_asc`:n.sort((e,t)=>parseInt(e.lprice)-parseInt(t.lprice));break;case`price_desc`:n.sort((e,t)=>parseInt(t.lprice)-parseInt(e.lprice));break;case`name_asc`:n.sort((e,t)=>e.title.localeCompare(t.title,`ko`));break;case`name_desc`:n.sort((e,t)=>t.title.localeCompare(e.title,`ko`));break;default:n.sort((e,t)=>parseInt(e.lprice)-parseInt(t.lprice))}return n}function o(t={}){let n=parseInt(t.page??t.current)||1,r=parseInt(t.limit)||20,i=t.search||``,o=t.category1||``,s=t.category2||``,c=t.sort||`price_asc`,l=a(e,{search:i,category1:o,category2:s,sort:c}),u=(n-1)*r,d=u+r,f=l.slice(u,d);return{products:f,pagination:{page:n,limit:r,total:l.length,totalPages:Math.ceil(l.length/r),hasNext:d<l.length,hasPrev:n>1},filters:{search:i,category1:o,category2:s,sort:c}}}n.get(`/api/products/:id`,({params:n})=>{let{id:r}=n,i=e.find(e=>e.productId===r);if(!i)return t.json({error:`Product not found`},{status:404});let a={...i,description:`${i.title}에 대한 상세 설명입니다. ${i.brand} 브랜드의 우수한 품질을 자랑하는 상품으로, 고객 만족도가 높은 제품입니다.`,rating:Math.floor(Math.random()*2)+4,reviewCount:Math.floor(Math.random()*1e3)+50,stock:Math.floor(Math.random()*100)+10,images:[i.image,i.image.replace(`.jpg`,`_2.jpg`),i.image.replace(`.jpg`,`_3.jpg`)]};return t.json(a)}),n.get(`/api/categories`,async()=>{let e=i();return await r(),t.json(e)});export{o as getProductsOnServer,i as getUniqueCategories};